!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){var r,i,u;r=e,i=t,u=n[t],(i=o(i))in r?Object.defineProperty(r,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[i]=u})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}var i=new(function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl=t,this.headers=r},(t=[{key:"getUserInfo",value:function(){return fetch("".concat(this.baseUrl,"/users/me"),{headers:this.headers}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"getInitialCards",value:function(){return fetch("".concat(this.baseUrl,"/cards"),{headers:this.headers}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"modifyUsersInfo",value:function(e,t){return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:r(r({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:e,about:t})}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"getNewCard",value:function(e,t){return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:r(r({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:e,link:t})}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"likeCard",value:function(e,t){var r=t?"PUT":"DELETE";return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:r,headers:this.headers}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){console.error("Error: can't apply like",e)}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"resetAvatar",value:function(e){return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:r(r({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({avatar:e})}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}}])&&n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}())("https://around.nomoreparties.co/v1/web_es_12",{authorization:"39689808-444a-43ae-b51c-8f177d6060a9"});function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var l=function(){return e=function e(t,r,n,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._title=t.name,this._link=t.link,this._likes=Array.isArray(t.likes)?t.likes:[],this._cardId=t._id,this._templateSelector=r,this._element=this._getTemplate(),this._element.id=this._cardId,this._cardImage=this._element.querySelector(".card__photo"),this._cardTitle=this._element.querySelector(".card__info-name"),this._likeButton=this._element.querySelector(".card__like-button"),this._counterLikes=this._element.querySelector(".card__likes"),this._currentUser=n,this._handleCardLike=o,this._handleCardDelete=i,this._ownerId=t.owner._id,this._bindListeners(),this._updateLikeStatus()},t=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}},{key:"_bindListeners",value:function(){var e=this;this._likeButton.addEventListener("click",(function(){return e._handleLike()})),this._cardImage.addEventListener("click",(function(){return e._handleImageClick()})),this._currentUser===this._ownerId&&this._element.querySelector(".card__delete-button").addEventListener("click",(function(){return e._handleDelete()}))}},{key:"_handleLike",value:function(){var e=this,t=!this._likes.some((function(t){return t._id===e._currentUser}));this._toggleLike(t)}},{key:"_toggleLike",value:function(e){var t=this;this._handleCardLike(this._cardId,e).then((function(e){if(!Array.isArray(e.likes))throw new Error("Invalid updated likes: not an array");t._likes=e.likes,t._updateLikeStatus()})).catch((function(e){console.error("Error toggling like: ".concat(e))}))}},{key:"_handleDelete",value:function(){var e=this;i.deleteCard(this._cardId).then((function(){e._element.remove()})).catch((function(e){return console.error("Error:",e)}))}},{key:"_handleImageClick",value:function(){var e=this,t=document.querySelector("#popup_image-open"),r=document.querySelector("#popup__close-image"),n=document.querySelector(".popup__image-title"),o=document.querySelector(".popup__image"),i=document.querySelector("#popup-overlay-image");o.src=this._link,n.textContent=this._title,o.alt=this._title,t.classList.add("popup_opened"),r.addEventListener("click",(function(){t.classList.remove("popup_opened"),i.removeEventListener("click",e._handleOverlayClick)})),i.addEventListener("click",(function(){t.classList.remove("popup_opened"),i.removeEventListener("click",e._handleOverlayClick)}))}},{key:"_updateLikeStatus",value:function(){var e=this;Array.isArray(this._likes)&&(this._likes.some((function(t){return t._id===e._currentUser}))?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active"),this._counterLikes.textContent=this._likes.length)}},{key:"generateCard",value:function(){return this._cardTitle.textContent=this._title,this._cardImage.src=this._link,this._cardImage.alt=this._title,this._updateLikeStatus(),this._element}}],t&&c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var y=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formElement=t,this._formSelector=r.formSelector,this._inputSelector=r.inputSelector,this._submitButtonSelector=r.submitButtonSelector,this._inactiveButtonClass=r.inactiveButtonClass,this._inputErrorClass=r.inputErrorClass,this._errorClass=r.errorClass,this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this.inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._setEventListeners()},(t=[{key:"_showInputError",value:function(e,t){e.classList.add(this._inputErrorClass),this._formElement.querySelector("#".concat(e.id,"-error")).textContent=t}},{key:"_hideInputError",value:function(e){e.classList.remove(this._inputErrorClass),this._formElement.querySelector("#".concat(e.id,"-error")).textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this.inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput(this.inputList)?this._buttonElement.classList.add(this._inactiveButtonClass):this._buttonElement.classList.remove(this._inactiveButtonClass)}},{key:"_setEventListeners",value:function(){var e=this;this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this.inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))})),this._toggleButtonState()}}])&&p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}var m=function(){return e=function e(t,r){var n=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=n,this._renderer=o,this._cardsSelector=r},(t=[{key:"render",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._cardsSelector.prepend(e)}}])&&d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}var g=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.popupSelector=document.querySelector(t),this.popupCloseButton=this.popupSelector.querySelector(".popup__close-button")},(t=[{key:"open",value:function(){this.popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose.bind(this))}},{key:"close",value:function(){this.popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose.bind(this))}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"_handleOverlayClick",value:function(e){return e.target.classList.contains("popup_opened")}},{key:"setEventListeners",value:function(){var e=this;this.popupCloseButton.addEventListener("click",(function(){e.close()})),this.popupSelector.addEventListener("click",(function(t){t.target===e.popupSelector&&e.close()}))}}])&&_(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function E(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}function O(e,t,r){return t=P(t),function(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,j()?Reflect.construct(t,r||[],P(e).constructor):t.apply(e,r))}function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(j=function(){return!!e})()}function L(){return L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},L.apply(this,arguments)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}var q=function(e){function t(e,r){var n,o=r.handleformAvatar;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=O(this,t,[e])).handleformAvatar=o,n._buttonAvatar=n.popupSelector.querySelector("#popup-avatar__close"),n._spanError=n.popupSelector.querySelector("#popup__input_avatar-error"),n.formAvatar=n.popupSelector.querySelector("#popup-avatar__form"),n.buttonSaveAvatar=n.popupSelector.querySelector("#popup-avatar__button"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(t,e),r=t,(n=[{key:"open",value:function(){L(P(t.prototype),"open",this).call(this),this.setEventListeners()}},{key:"setEventListeners",value:function(){L(P(t.prototype),"setEventListeners",this).call(this),this._buttonAvatar.addEventListener("click",(function(e){e.preventDefault()}))}},{key:"close",value:function(){L(P(t.prototype),"close",this).call(this),this.formAvatar.reset()}}])&&k(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(g);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B(n.key),n)}}function B(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==I(t)?t:t+""}function D(e,t,r){return t=R(t),function(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,A()?Reflect.construct(t,r||[],R(e).constructor):t.apply(e,r))}function A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(A=function(){return!!e})()}function x(){return x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},x.apply(this,arguments)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}var N=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=D(this,t,[e])).handleFormSubmit=r,n.form=n.popupSelector.querySelector(".popup__form"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(t,e),r=t,(n=[{key:"_getInputValues",value:function(){return{name:this.popupSelector.querySelector(".popup__input_title").value,link:this.popupSelector.querySelector("#popup__input_image").value}}},{key:"setEventListeners",value:function(){var e=this;x(R(t.prototype),"setEventListeners",this).call(this),this.form.addEventListener("submit",(function(t){t.preventDefault(),e.handleFormSubmit(t)}))}},{key:"close",value:function(){x(R(t.prototype),"close",this).call(this),this.form.reset()}}])&&T(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(g);function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F(n.key),n)}}function F(e){var t=function(e,t){if("object"!=J(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==J(t)?t:t+""}function H(e,t,r){return t=G(t),function(e,t){if(t&&("object"===J(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,z()?Reflect.construct(t,r||[],G(e).constructor):t.apply(e,r))}function z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(z=function(){return!!e})()}function M(){return M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=G(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},M.apply(this,arguments)}function G(e){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},G(e)}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}var Q,W=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=H(this,t,[e])).image=r.popupSelector.querySelector(".popup__image"),r.title=r.popupSelector.querySelector(".popup__image-title"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(t,e),r=t,(n=[{key:"open",value:function(e,r){M(G(t.prototype),"open",this).call(this),this.image.src=e,this.title.textContent=r}}])&&V(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(g),X=document.querySelector(".profile__avatar"),Y=document.querySelector(".profile__name"),Z=document.querySelector(".profile__about"),$=document.querySelector(".profile__edit-button"),ee=document.querySelector(".popup__form"),te=document.querySelector("#form-cards"),re=document.querySelector(".popup__input_name"),ne=document.querySelector(".popup__input_about"),oe=document.querySelector(".profile__add-button"),ie=document.querySelector(".popup__input_title"),ue=document.querySelector("#popup__input_image"),ce=document.querySelector(".cards"),ae=document.getElementById("add-image-popup").querySelector(".popup__form"),le=document.querySelector(".profile__edit-icon"),se=document.querySelector("#popup-avatar__form"),pe=document.querySelector("#popup-avatar__button"),fe=document.querySelector("#popup-profile__button"),ye=document.querySelector("#popup-card__button");function ve(e){e.preventDefault();var t=re.value,r=ne.value;fe.textContent="Saving...",i.modifyUsersInfo(t,r).then((function(e){Y.textContent=e.name,Z.textContent=e.about,me.close(),fe.textContent="Save"}))}i.getUserInfo().then((function(e){Y.textContent=e.name,Z.textContent=e.about,X.src=e.avatar,Q=e._id,i.getInitialCards().then((function(e){var t=new m({items:e,renderer:function(e){var r=new l(e,".template-card",Q,Oe,je).generateCard();t.addItem(r)}},ce);t.render()}))}));var de=new g(".popup"),he=new N("#add-image-popup",(function(e){e.preventDefault(),he.close()})),me=new N(".popup",ve),be=new W("#popup_image-open"),_e=new q("#popup-avatar",{handleformAvatar:Ee}),Se=document.querySelector("#popup-overlay-edit"),ge=document.querySelector("#popup-overlay-add"),we=document.querySelector("#popup-overlay-image"),ke=document.querySelector("#popup-overlay-avatar");function Ee(e){e.preventDefault();var t=se.querySelector(".popup__input").value;pe.textContent="Saving...",i.resetAvatar(t).then((function(e){X.src=e.avatar,_e.close(),pe.textContent="Save"}))}function Oe(e,t){return i.likeCard(e,t).then((function(e){return e})).catch((function(e){throw e}))}function je(e){i.deleteCard(e).then((function(){document.getElementById(e).remove()}))}function Le(e){e.target.classList.contains("popup__overlay")&&(de.close(),he.close(),be.close(),_e.close())}function Pe(e){"Escape"===e.key&&(de.close(),he.close(),be.close(),_e.close(),document.removeEventListener("keydown",Pe))}$.addEventListener("click",(function(){de.open(),i.getUserInfo().then((function(e){re.value=e.name,ne.value=e.about}))})),ee.addEventListener("submit",ve),oe.addEventListener("click",(function(){return he.open()})),ae.addEventListener("submit",(function(e){e.preventDefault(),ye.textContent="Saving...",ie.value&&ue.value&&i.getNewCard(ie.value,ue.value).then((function(e){var t=new l(e,".template-card",Q,Oe,je).generateCard();ce.prepend(t),ie.value="",ue.value="",he.close(),ye.textContent="Save"}))})),le.addEventListener("click",(function(){return _e.open()})),se.addEventListener("submit",Ee),he.setEventListeners(),Se.addEventListener("click",Le),ge.addEventListener("click",Le),we.addEventListener("click",Le),ke.addEventListener("click",Le),document.addEventListener("keydown",(function(e){return Pe(e)}));var Ce={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};new y(ee,Ce)._setEventListeners(),new y(te,Ce)._setEventListeners(),new y(se,Ce)._setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OUssTUFBUSxHQUNuQitLLEdBQVcvSyxNQUFRLEdBQ25Cd00sR0FBYzVELFFBQ2QwQyxHQUFlckcsWUFBYyxNQUMvQixHQUVKLElBOERBa0csR0FBb0J4SCxpQkFBaUIsU0FBUyxrQkFBTStJLEdBQWdCVyxNQUFNLElBQzFFakMsR0FBa0J6SCxpQkFBaUIsU0FBVWdKLElBRTdDSCxHQUFjNUMsb0JBRWRnRCxHQUFZakosaUJBQWlCLFFBQVN1SixJQUN0Q0wsR0FBV2xKLGlCQUFpQixRQUFTdUosSUFDckNuSSxHQUFhcEIsaUJBQWlCLFFBQVN1SixJQUN2Q0osR0FBY25KLGlCQUFpQixRQUFTdUosSUFFeEMzSixTQUFTSSxpQkFBaUIsV0FBVyxTQUFDd0osR0FBSyxPQUFLQyxHQUFhRCxFQUFNLElBRW5FLElBQU14SCxHQUFXLENBQ2ZHLGFBQWMsZUFDZEUsY0FBZSxnQkFDZkUscUJBQXNCLHNCQUN0QkUsb0JBQXFCLHlCQUNyQkUsZ0JBQWlCLDBCQUNqQkUsV0FBWSx3QkFHYyxJQUFJZixFQUFjQyxHQUFhQyxJQUN2Q2tCLHFCQUNLLElBQUlwQixFQUFjaUYsR0FBaUIvRSxJQUMzQ2tCLHFCQUNVLElBQUlwQixFQUFjMkYsR0FBbUJ6RixJQUM3Q2tCLG9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9Qb3B1cFdpdGhBdmF0YXIuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihiYXNlVXJsLCBoZWFkZXJzKSB7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7IGhlYWRlcnM6IHRoaXMuaGVhZGVycyB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcihgU2VydmVyIGVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvcjpcIiwgZXJyb3IpKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwgeyBoZWFkZXJzOiB0aGlzLmhlYWRlcnMgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciBlcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XHJcbiAgfVxyXG5cclxuICBtb2RpZnlVc2Vyc0luZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIC4uLnRoaXMuaGVhZGVycyxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKGBTZXJ2ZXIgZXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnJvcikpO1xyXG4gIH1cclxuXHJcbiAgZ2V0TmV3Q2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIC4uLnRoaXMuaGVhZGVycyxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciBlcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQsIGlzTGlrZWQpIHtcclxuICAgIGNvbnN0IG1ldGhvZCA9IGlzTGlrZWQgPyBcIlBVVFwiIDogXCJERUxFVEVcIjtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBtZXRob2QsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKGBTZXJ2ZXIgZXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvcjogY2FuJ3QgYXBwbHkgbGlrZVwiLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciBlcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XHJcbiAgfVxyXG5cclxuICByZXNldEF2YXRhcih1cmwpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAuLi50aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiB1cmwgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcihgU2VydmVyIGVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvcjpcIiwgZXJyb3IpKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS93ZWJfZXNfMTJcIiwge1xyXG4gIGF1dGhvcml6YXRpb246IFwiMzk2ODk4MDgtNDQ0YS00M2FlLWI1MWMtOGYxNzdkNjA2MGE5XCIsXHJcbn0pO1xyXG4iLCJpbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGNhcmREYXRhLFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcclxuICAgIGN1cnJlbnRVc2VyLFxyXG4gICAgaGFuZGxlQ2FyZExpa2UsXHJcbiAgICBoYW5kbGVDYXJkRGVsZXRlXHJcbiAgKSB7XHJcbiAgICB0aGlzLl90aXRsZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2xpa2VzID0gQXJyYXkuaXNBcnJheShjYXJkRGF0YS5saWtlcykgPyBjYXJkRGF0YS5saWtlcyA6IFtdO1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQuaWQgPSB0aGlzLl9jYXJkSWQ7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fcGhvdG9cIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW5mby1uYW1lXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2NvdW50ZXJMaWtlcyA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlc1wiKTtcclxuICAgIHRoaXMuX2N1cnJlbnRVc2VyID0gY3VycmVudFVzZXI7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSA9IGhhbmRsZUNhcmREZWxldGU7XHJcbiAgICB0aGlzLl9vd25lcklkID0gY2FyZERhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fYmluZExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZVN0YXR1cygpO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xyXG4gICAgcmV0dXJuIGNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBfYmluZExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2UoKSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soKSk7XHJcbiAgICBpZiAodGhpcy5fY3VycmVudFVzZXIgPT09IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgY29uc3QgZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcbiAgICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlKCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2UoKSB7XHJcbiAgICBjb25zdCBpc0xpa2VkID0gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX2N1cnJlbnRVc2VyKTtcclxuICAgIGNvbnN0IGxpa2VTdGF0dXMgPSAhaXNMaWtlZDtcclxuICAgIHRoaXMuX3RvZ2dsZUxpa2UobGlrZVN0YXR1cyk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlTGlrZShsaWtlU3RhdHVzKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSh0aGlzLl9jYXJkSWQsIGxpa2VTdGF0dXMpXHJcbiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZXNwb25zZS5saWtlcykpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdXBkYXRlZCBsaWtlczogbm90IGFuIGFycmF5XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9saWtlcyA9IHJlc3BvbnNlLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZUxpa2VTdGF0dXMoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciB0b2dnbGluZyBsaWtlOiAke2Vycn1gKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRGVsZXRlKCkge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKHRoaXMuX2NhcmRJZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvcjpcIiwgZXJyb3IpKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVJbWFnZUNsaWNrKCkge1xyXG4gICAgY29uc3QgcG9wdXBJbWFnZU9wZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwX2ltYWdlLW9wZW5cIik7XHJcbiAgICBjb25zdCBjbG9zZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cF9fY2xvc2UtaW1hZ2VcIik7XHJcbiAgICBjb25zdCBwb3B1cEltYWdlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZS10aXRsZVwiKTtcclxuICAgIGNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuICAgIGNvbnN0IG92ZXJsYXlJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtb3ZlcmxheS1pbWFnZVwiKTtcclxuICAgIHBvcHVwSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHBvcHVwSW1hZ2VUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgcG9wdXBJbWFnZS5hbHQgPSB0aGlzLl90aXRsZTtcclxuICAgIHBvcHVwSW1hZ2VPcGVuLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBjbG9zZUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW1hZ2VPcGVuLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICAgIG92ZXJsYXlJbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsaWNrKTtcclxuICAgIH0pO1xyXG4gICAgb3ZlcmxheUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW1hZ2VPcGVuLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICAgIG92ZXJsYXlJbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsaWNrKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3VwZGF0ZUxpa2VTdGF0dXMoKSB7XHJcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5fbGlrZXMpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGlzTGlrZWQgPSB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fY3VycmVudFVzZXIpO1xyXG4gICAgaWYgKGlzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fY291bnRlckxpa2VzLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl90aXRsZTtcclxuICAgIHRoaXMuX3VwZGF0ZUxpa2VTdGF0dXMoKTtcclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgc2V0dGluZ3MpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZXR0aW5ncy5mb3JtU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLmlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuaW5wdXRMaXN0LmZvckVhY2goKGVsKSA9PiB7XHJcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNhcmRzU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY2FyZHNTZWxlY3RvciA9IGNhcmRzU2VsZWN0b3I7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NhcmRzU2VsZWN0b3IucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMucG9wdXBTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLnBvcHVwQ2xvc2VCdXR0b24gPSB0aGlzLnBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMucG9wdXBTZWxlY3Rvci5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMucG9wdXBTZWxlY3Rvci5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlT3ZlcmxheUNsaWNrKGV2dCkge1xyXG4gICAgcmV0dXJuIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLnBvcHVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5wb3B1cFNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLnBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEF2YXRhciBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB7IGhhbmRsZWZvcm1BdmF0YXIgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLmhhbmRsZWZvcm1BdmF0YXIgPSBoYW5kbGVmb3JtQXZhdGFyO1xyXG4gICAgdGhpcy5fYnV0dG9uQXZhdGFyID0gdGhpcy5wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiI3BvcHVwLWF2YXRhcl9fY2xvc2VcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3NwYW5FcnJvciA9IHRoaXMucG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIiNwb3B1cF9faW5wdXRfYXZhdGFyLWVycm9yXCJcclxuICAgICk7XHJcbiAgICB0aGlzLmZvcm1BdmF0YXIgPSB0aGlzLnBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1hdmF0YXJfX2Zvcm1cIik7XHJcbiAgICB0aGlzLmJ1dHRvblNhdmVBdmF0YXIgPSB0aGlzLnBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIjcG9wdXAtYXZhdGFyX19idXR0b25cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9idXR0b25BdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuZm9ybUF2YXRhci5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLmhhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5mb3JtID0gdGhpcy5wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLnBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdGl0bGVcIikudmFsdWUsXHJcbiAgICAgIGxpbms6IHRoaXMucG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwX19pbnB1dF9pbWFnZVwiKS52YWx1ZSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLmhhbmRsZUZvcm1TdWJtaXQoZXZ0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLmltYWdlID0gdGhpcy5wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy50aXRsZSA9IHRoaXMucG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZS10aXRsZVwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oaW1hZ2VTcmMsIHRpdGxlVGV4dCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5pbWFnZS5zcmMgPSBpbWFnZVNyYztcclxuICAgIHRoaXMudGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZVRleHQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vc3R5bGVzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi9zY3JpcHRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4vc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuL3NjcmlwdHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4vc2NyaXB0cy9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQXZhdGFyIGZyb20gXCIuL3NjcmlwdHMvUG9wdXBXaXRoQXZhdGFyLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4vc2NyaXB0cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi91dGlscy9BcGkuanNcIjtcclxuXHJcbmNvbnN0IGltYWdlUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5jb25zdCBwcm9maWxlTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVBYm91dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Fib3V0XCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcblxyXG5jb25zdCBmb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1jYXJkc1wiKTtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfbmFtZVwiKTtcclxuY29uc3QgYWJvdXRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X2Fib3V0XCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCB0aXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdGl0bGVcIik7XHJcbmNvbnN0IGltYWdlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwX19pbnB1dF9pbWFnZVwiKTtcclxuY29uc3QgY2FyZEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzXCIpO1xyXG5jb25zdCBncm91cEltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtaW1hZ2UtcG9wdXBcIik7XHJcbmNvbnN0IGZvcm1DYXJkID0gZ3JvdXBJbWFnZS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWljb25cIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1hdmF0YXJfX2Zvcm1cIik7XHJcbmNvbnN0IGJ1dHRvblNhdmVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWF2YXRhcl9fYnV0dG9uXCIpO1xyXG5jb25zdCBidXR0b25TYXZlUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtcHJvZmlsZV9fYnV0dG9uXCIpO1xyXG5jb25zdCBidXR0b25TYXZlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtY2FyZF9fYnV0dG9uXCIpO1xyXG5cclxubGV0IGN1cnJlbnRVc2VyO1xyXG5cclxuYXBpLmdldFVzZXJJbmZvKCkudGhlbigodXNlckRhdGEpID0+IHtcclxuICBwcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gIHByb2ZpbGVBYm91dEVsZW1lbnQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICBpbWFnZVByb2ZpbGUuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xyXG4gIGN1cnJlbnRVc2VyID0gdXNlckRhdGEuX2lkO1xyXG5cclxuICBhcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigoY2FyZHMpID0+IHtcclxuICAgIGNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBjYXJkcyxcclxuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgICAgICAgICAgaXRlbSxcclxuICAgICAgICAgICAgXCIudGVtcGxhdGUtY2FyZFwiLFxyXG4gICAgICAgICAgICBjdXJyZW50VXNlcixcclxuICAgICAgICAgICAgbGlrZUNhcmQsXHJcbiAgICAgICAgICAgIGhhbmRsZUNhcmREZWxldGVcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRBcmVhXHJcbiAgICApO1xyXG5cclxuICAgIHNlY3Rpb24ucmVuZGVyKCk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gc2V0VXNlckluZm8oKSB7XHJcbiAgYXBpLmdldFVzZXJJbmZvKCkudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgIG5hbWVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgICBhYm91dElucHV0LnZhbHVlID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IG5ld05hbWUgPSBuYW1lSW5wdXQudmFsdWU7XHJcbiAgY29uc3QgbmV3QWJvdXQgPSBhYm91dElucHV0LnZhbHVlO1xyXG4gIGJ1dHRvblNhdmVQcm9maWxlLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICBhcGkubW9kaWZ5VXNlcnNJbmZvKG5ld05hbWUsIG5ld0Fib3V0KS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICBwcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcm9maWxlQWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuICAgIGJ1dHRvblNhdmVQcm9maWxlLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cChcIi5wb3B1cFwiKTtcclxuXHJcbmNvbnN0IGFkZEltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNhZGQtaW1hZ2UtcG9wdXBcIixcclxuICBoYW5kbGVBZGRJbWFnZUZvcm1TdWJtaXRcclxuKTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cFwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3BvcHVwX2ltYWdlLW9wZW5cIik7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoQXZhdGFyKFwiI3BvcHVwLWF2YXRhclwiLCB7XHJcbiAgaGFuZGxlZm9ybUF2YXRhcjogaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCxcclxufSk7XHJcblxyXG5jb25zdCBvdmVybGF5RWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtb3ZlcmxheS1lZGl0XCIpO1xyXG5jb25zdCBvdmVybGF5QWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1vdmVybGF5LWFkZFwiKTtcclxuY29uc3Qgb3ZlcmxheUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1vdmVybGF5LWltYWdlXCIpO1xyXG5jb25zdCBvdmVybGF5QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1vdmVybGF5LWF2YXRhclwiKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZEltYWdlRm9ybVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBhZGRJbWFnZVBvcHVwLmNsb3NlKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgYnV0dG9uU2F2ZUNhcmQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gIGlmICh0aXRsZUlucHV0LnZhbHVlICYmIGltYWdlSW5wdXQudmFsdWUpIHtcclxuICAgIGFwaS5nZXROZXdDYXJkKHRpdGxlSW5wdXQudmFsdWUsIGltYWdlSW5wdXQudmFsdWUpLnRoZW4oKG5ld0NhcmQpID0+IHtcclxuICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgICAgIG5ld0NhcmQsXHJcbiAgICAgICAgXCIudGVtcGxhdGUtY2FyZFwiLFxyXG4gICAgICAgIGN1cnJlbnRVc2VyLFxyXG4gICAgICAgIGxpa2VDYXJkLFxyXG4gICAgICAgIGhhbmRsZUNhcmREZWxldGVcclxuICAgICAgKTtcclxuICAgICAgY29uc3QgbmV3Q2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gICAgICBjYXJkQXJlYS5wcmVwZW5kKG5ld0NhcmRFbGVtZW50KTtcclxuICAgICAgdGl0bGVJbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgIGltYWdlSW5wdXQudmFsdWUgPSBcIlwiO1xyXG4gICAgICBhZGRJbWFnZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIGJ1dHRvblNhdmVDYXJkLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgbmV3QXZhdGFyVXJsID0gZm9ybUVsZW1lbnRBdmF0YXIucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRcIikudmFsdWU7XHJcbiAgYnV0dG9uU2F2ZUF2YXRhci50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgYXBpLnJlc2V0QXZhdGFyKG5ld0F2YXRhclVybCkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgaW1hZ2VQcm9maWxlLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgICBidXR0b25TYXZlQXZhdGFyLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxpa2VDYXJkKGNhcmRJZCwgaXNMaWtlZCkge1xyXG4gIHJldHVybiBhcGlcclxuICAgIC5saWtlQ2FyZChjYXJkSWQsIGlzTGlrZWQpXHJcbiAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgcmV0dXJuIHVwZGF0ZWRDYXJkO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIHRocm93IGVycjtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkRGVsZXRlKGNhcmRJZCkge1xyXG4gIGFwaS5kZWxldGVDYXJkKGNhcmRJZCkudGhlbigoKSA9PiB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhcmRJZCk7XHJcbiAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlT3ZlcmxheUNsaWNrKGV2ZW50KSB7XHJcbiAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fb3ZlcmxheVwiKSkge1xyXG4gICAgZWRpdFBvcHVwLmNsb3NlKCk7XHJcbiAgICBhZGRJbWFnZVBvcHVwLmNsb3NlKCk7XHJcbiAgICBpbWFnZVBvcHVwLmNsb3NlKCk7XHJcbiAgICBlZGl0QXZhdGFyUG9wdXAuY2xvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlUG9wdXBzKCkge1xyXG4gIGVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gIGFkZEltYWdlUG9wdXAuY2xvc2UoKTtcclxuICBpbWFnZVBvcHVwLmNsb3NlKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VXaXRoRXNjKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VXaXRoRXNjKGV2ZW50KSB7XHJcbiAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY2xvc2VQb3B1cHMoKTtcclxuICB9XHJcbn1cclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdFBvcHVwLm9wZW4oKTtcclxuICBzZXRVc2VySW5mbygpO1xyXG59KTtcclxuXHJcbmZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xyXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBhZGRJbWFnZVBvcHVwLm9wZW4oKSk7XHJcbmZvcm1DYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XHJcbnByb2ZpbGVBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGVkaXRBdmF0YXJQb3B1cC5vcGVuKCkpO1xyXG5mb3JtRWxlbWVudEF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQpO1xyXG5cclxuYWRkSW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxub3ZlcmxheUVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbGljayk7XHJcbm92ZXJsYXlBZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbGljayk7XHJcbm92ZXJsYXlJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcclxub3ZlcmxheUF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChldmVudCkgPT4gY2xvc2VXaXRoRXNjKGV2ZW50KSk7XHJcblxyXG5jb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlLWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmNvbnN0IHZhbGlkYXRlRm9ybVByb2ZpbGUgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtRWxlbWVudCwgc2V0dGluZ3MpO1xyXG52YWxpZGF0ZUZvcm1Qcm9maWxlLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdCB2YWxpZGF0ZUZvcm1DYXJkID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUVsZW1lbnRDYXJkLCBzZXR0aW5ncyk7XHJcbnZhbGlkYXRlRm9ybUNhcmQuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IHZhbGlkYXRlRm9ybUF2YXRhciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1FbGVtZW50QXZhdGFyLCBzZXR0aW5ncyk7XHJcbnZhbGlkYXRlRm9ybUF2YXRhci5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuIl0sIm5hbWVzIjpbImFwaSIsIkFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsImtleSIsInZhbHVlIiwiZmV0Y2giLCJjb25jYXQiLCJ0aGVuIiwicmVzIiwib2siLCJFcnJvciIsInN0YXR1cyIsImpzb24iLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsIl9vYmplY3RTcHJlYWQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImxpbmsiLCJjYXJkSWQiLCJpc0xpa2VkIiwiaWQiLCJ1cmwiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiQ2FyZCIsImNhcmREYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImN1cnJlbnRVc2VyIiwiaGFuZGxlQ2FyZExpa2UiLCJoYW5kbGVDYXJkRGVsZXRlIiwiX3RpdGxlIiwiX2xpbmsiLCJfbGlrZXMiLCJBcnJheSIsImlzQXJyYXkiLCJsaWtlcyIsIl9jYXJkSWQiLCJfaWQiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX2NhcmRJbWFnZSIsInF1ZXJ5U2VsZWN0b3IiLCJfY2FyZFRpdGxlIiwiX2xpa2VCdXR0b24iLCJfY291bnRlckxpa2VzIiwiX2N1cnJlbnRVc2VyIiwiX2hhbmRsZUNhcmRMaWtlIiwiX2hhbmRsZUNhcmREZWxldGUiLCJfb3duZXJJZCIsIm93bmVyIiwiX2JpbmRMaXN0ZW5lcnMiLCJfdXBkYXRlTGlrZVN0YXR1cyIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl90aGlzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlIiwiX3RoaXMyIiwibGlrZVN0YXR1cyIsInNvbWUiLCJsaWtlIiwiX3RvZ2dsZUxpa2UiLCJfdGhpczMiLCJyZXNwb25zZSIsImVyciIsIl90aGlzNCIsImRlbGV0ZUNhcmQiLCJyZW1vdmUiLCJfdGhpczUiLCJwb3B1cEltYWdlT3BlbiIsImNsb3NlSW1hZ2UiLCJwb3B1cEltYWdlVGl0bGUiLCJwb3B1cEltYWdlIiwib3ZlcmxheUltYWdlIiwic3JjIiwidGV4dENvbnRlbnQiLCJhbHQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZU92ZXJsYXlDbGljayIsIl90aGlzNiIsImxlbmd0aCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsInNldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9idXR0b25FbGVtZW50IiwiaW5wdXRMaXN0IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0IiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJmb3JFYWNoIiwiZWwiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiU2VjdGlvbiIsIl9yZWYiLCJjYXJkc1NlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jYXJkc1NlbGVjdG9yIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwicG9wdXBDbG9zZUJ1dHRvbiIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoQXZhdGFyIiwiX1BvcHVwIiwiaGFuZGxlZm9ybUF2YXRhciIsIl9jYWxsU3VwZXIiLCJfYnV0dG9uQXZhdGFyIiwiX3NwYW5FcnJvciIsImZvcm1BdmF0YXIiLCJidXR0b25TYXZlQXZhdGFyIiwiX2luaGVyaXRzIiwiX2dldCIsIl9nZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsImNhbGwiLCJzZXRFdmVudExpc3RlbmVycyIsInJlc2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJmb3JtIiwiUG9wdXBXaXRoSW1hZ2UiLCJpbWFnZSIsInRpdGxlIiwiaW1hZ2VTcmMiLCJ0aXRsZVRleHQiLCJpbWFnZVByb2ZpbGUiLCJwcm9maWxlTmFtZUVsZW1lbnQiLCJwcm9maWxlQWJvdXRFbGVtZW50IiwicHJvZmlsZUVkaXRCdXR0b24iLCJmb3JtRWxlbWVudENhcmQiLCJuYW1lSW5wdXQiLCJhYm91dElucHV0IiwicHJvZmlsZUFkZEJ1dHRvbiIsInRpdGxlSW5wdXQiLCJpbWFnZUlucHV0IiwiY2FyZEFyZWEiLCJmb3JtQ2FyZCIsImdldEVsZW1lbnRCeUlkIiwicHJvZmlsZUF2YXRhckJ1dHRvbiIsImZvcm1FbGVtZW50QXZhdGFyIiwiYnV0dG9uU2F2ZVByb2ZpbGUiLCJidXR0b25TYXZlQ2FyZCIsImhhbmRsZVByb2ZpbGVGb3JtU3VibWl0IiwibmV3TmFtZSIsIm5ld0Fib3V0IiwibW9kaWZ5VXNlcnNJbmZvIiwiZGF0YSIsImVkaXRQcm9maWxlUG9wdXAiLCJnZXRVc2VySW5mbyIsInVzZXJEYXRhIiwiZ2V0SW5pdGlhbENhcmRzIiwiY2FyZHMiLCJzZWN0aW9uIiwiY2FyZEVsZW1lbnQiLCJsaWtlQ2FyZCIsImdlbmVyYXRlQ2FyZCIsImFkZEl0ZW0iLCJyZW5kZXIiLCJlZGl0UG9wdXAiLCJhZGRJbWFnZVBvcHVwIiwiaW1hZ2VQb3B1cCIsImVkaXRBdmF0YXJQb3B1cCIsImhhbmRsZUF2YXRhckZvcm1TdWJtaXQiLCJvdmVybGF5RWRpdCIsIm92ZXJsYXlBZGQiLCJvdmVybGF5QXZhdGFyIiwibmV3QXZhdGFyVXJsIiwicmVzZXRBdmF0YXIiLCJ1cGRhdGVkQ2FyZCIsImhhbmRsZU92ZXJsYXlDbGljayIsImV2ZW50IiwiY2xvc2VXaXRoRXNjIiwib3BlbiIsImdldE5ld0NhcmQiLCJuZXdDYXJkIiwibmV3Q2FyZEVsZW1lbnQiXSwic291cmNlUm9vdCI6IiJ9